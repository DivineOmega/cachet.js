<!DOCTYPE html>
<html>
    <head>
        <title><!-- cachet.js examples --></title>
    </head>
    
    <body>
        
        <h1><!-- cachet.js examples --></h1>
        
        <h2>Get All Components</h2>
        
        <ul id="components"></ul>
        
        <h2>Get Single Component by ID</h2>
        
        <ul id="component"></ul>
        
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
        <script src="cachet.js"></script>
        
        <h2>Update Component Status</h2>
        
        <p>
            ID: <input type="text" id="id_to_update" size="2" value="1" /> 
            Status:  
                <select id="status_to_update">
                    <option value="1">Operational</option>
                    <option value="2">Performance Issues</option>
                    <option value="3">Partial Outage</option>
                    <option value="4">Major Outage</option>
                </select>
            <input type="submit" value="Update" id="update_button" />
        </p>
        
        <ul id="updated_component"></ul>
        
        <script>
            
            // Create a cachetjs object
            var cachetjs = new cachetjs;
            
            // Set the base URL for your cachet instance API
            cachetjs.setBaseURL('https://demo.cachethq.io/api/');
            
            // If you need to change things, you need to provide the email and password you user to log in to the Cachet dashboard
            cachetjs.setEmail('test@test.com');
            cachetjs.setPassword('test123');
            
            // Get all components for this cachet instance
            cachetjs.getComponents(function(components)
            {
                var html = '';
                
                for (var i = 0; i < components.length; i++)
                {
                    html += '<li> ID ' + components[i].id + ' - ' + components[i].name + ' ';
                    if (components[i].description) html += ' - ' + components[i].description;
                    html += ' - ' + components[i].status;
                    html += '</li>';
                }
                
                $('#components').html(html); 
                
            });
            
            // Get a components by ID
            var id = 1;
            cachetjs.getComponentByID(id, function(component)
            {
                html = '';
                
                html += '<li>ID: ' + component.id + '</li>';
                html += '<li>Name: ' + component.name + '</li>';
                if (component.description) html += '<li>Description: ' + component.description + '</li>';
                html += '<li>Status: ' + component.status + '</li>';
                
                $('#component').html(html); 
                
            });
            
            // When update button is clicked
            $('#update_button').on('click', function()
            {
                var id = $('#id_to_update').val();
                var status = $('#status_to_update').val();
                
                // Set component status
                cachetjs.setComponentStatusByID(id, status, function(component)
                {
                    html = 'Status of component '+component.id+' now set to '+component.status;
                
                    $('#updated_component').html(html); 
                    
                });
            });
            
        </script>
        
    </body>

</html> 